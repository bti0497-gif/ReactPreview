# 기술진단팀 협업 플랫폼 동기화 전략 (Sync Strategy)

본 문서는 기술진단팀 팀원 간의 업무 데이터 및 파일 공유가 어떻게 동기화되는지 정의합니다.

## 1. 목적 (Purpose)
팀원 간의 실시간에 가까운 업무 공유를 보장하고, 구글 드라이브(Google Drive)를 중앙 저장소(Sovereign Storage)로 활용하여 위치에 구애받지 않는 작업 환경을 구축합니다.

---

## 2. 동기화 구성 요소 (Synchronization Components)

### 2.1. 파일 공유 (Direct File Sharing)
*   **저장소**: 구글 드라이브 공유 폴더 (루트 하위)
*   **방식**: `FileManager` 컴포넌트를 통해 직접 업로드 및 다운로드.
*   **특징**: 대용량 리소스 파일(도면, 사진, 보고서 등)은 로컬에 저장하지 않고 클라우드에서 직접 관리합니다.

### 2.2. 업무 데이터 공유 (Structured Data Sync via Command Replication)
*   **대상**: 프로젝트 관리, 공정 관리, 할일 관리, 전체 게시판 데이터.
*   **방식**: **트랜잭션 로그 (Action Log)** 기반 동기화.
*   **아키텍처**:
    1.  **Action Detection**: 데이터가 추가, 수정, 삭제될 때 개별 데이터 파일 외에 `ACTION_타임스탬프.json` 형식의 명령 로그를 생성합니다.
    2.  **Log Composition**: 명령 로그에는 작업 유형(CRUD), 대상 테이블, 고유 ID(UUID), 변경 시각이 포함됩니다.
    3.  **Client Sync**: 로컬 앱은 드라이브에서 최신 `ACTION` 로그들을 읽어와서 본인의 로컬 DB에 순차적으로 적용합니다.
        *   **삭제(DELETE)**: 명령에 포함된 ID를 로컬 DB에서 즉시 제거.
        *   **업데이트(UPDATE/CREATE)**: 해당 ID의 최신 JSON 파일을 읽어 로컬 DB 갱신.
    4.  **Full Re-sync**: 로그 보존 기간(7일)을 초과하여 장기간 접속하지 않은 클라이언트는 전체 목록을 다시 읽어 싱크를 맞춥니다.

---

## 3. 데이터 보존 정책 (Retention Policy)

클라우드 스토리지의 효율적인 관리를 위해 다음 정책을 자동으로 실행합니다.

*   **정리 주기**: 매 앱 실행 시 또는 특정 주기.
*   **대상**: `.system/json` 폴더 내의 로그성 JSON 데이터.
*   **삭제 기준**: 생성된 지 **7일(일주일)**이 경과된 데이터는 스토리지에서 자동으로 삭제됩니다.
*   **영구 보존**: 게시글의 본문 데이터 등은 필요에 따라 중앙 DB로 통합되거나 로컬에 보관될 수 있으나, 공유용 로그 파일은 휘발성으로 관리합니다.

---

## 4. 작업 환경 간 전이 (Portability)
데이터가 JSON 파일로 공유되므로, 동일한 `.env` 설정(구글 드라이브 권한)을 가진 모든 작업 환경에서는 동일한 최신 업무 상태를 유지할 수 있습니다.
